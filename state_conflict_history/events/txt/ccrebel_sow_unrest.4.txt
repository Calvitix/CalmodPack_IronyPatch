namespace = ccrebel_sow_unrest
country_event = {
    id = ccrebel_sow_unrest.4
    title = ccrebel_sow_unrest.4.name
    desc = {
        trigger = {
            any_relation = {
                has_relation_flag = {
                    flag = ccrebel_subsidised_rebels
                    who = root
                }
            }
        }
        text = ccrebel_sow_unrest.4.desc
    }
    desc = {
        trigger = {
            any_relation = {
                has_relation_flag = {
                    flag = ccrebel_may_support_rebels
                    who = root
                }
            }
        }
        text = ccrebel_sow_unrest.4.desc.not_sown_unrest
    }
    diplomatic = yes
    picture_event_data = {
        portrait = event_target:ccrebel_subsidised_rebels
        planet_background = event_target:ccrebel_subsidised_rebels.capital_scope
        city_level = event_target:ccrebel_subsidised_rebels.capital_scope
        room = event_target:ccrebel_subsidised_rebels
    }
    is_triggered_only = yes
    trigger = {
        exists = root
        NOR = {
            has_valid_civic = civic_fanatic_purifiers
            has_valid_civic = civic_hive_devouring_swarm
            has_valid_civic = civic_machine_terminator
            has_valid_civic = civic_barbaric_despoilers
        }
        any_country = {
            NOR = {
                has_valid_civic = civic_fanatic_purifiers
                has_valid_civic = civic_hive_devouring_swarm
                has_valid_civic = civic_machine_terminator
                has_valid_civic = civic_barbaric_despoilers
            }
            OR = {
                has_relation_flag = {
                    flag = ccrebel_may_support_rebels
                    who = root
                }
                has_relation_flag = {
                    flag = ccrebel_subsidised_rebels
                    who = root
                }
            }
        }
    }
    immediate = {
        random_country = {
            limit = {
                NOR = {
                    has_valid_civic = civic_fanatic_purifiers
                    has_valid_civic = civic_hive_devouring_swarm
                    has_valid_civic = civic_machine_terminator
                    has_valid_civic = civic_barbaric_despoilers
                }
                OR = {
                    has_relation_flag = {
                        flag = ccrebel_subsidised_rebels
                        who = root
                    }
                    has_relation_flag = {
                        flag = ccrebel_may_support_rebels
                        who = root
                    }
                }
            }
            save_event_target_as = ccrebel_subsidised_rebels
        }
        if = {
            limit = {
                exists = event_target:old_owner
                NOT = {
                    exists = event_target:ccrebel_revolted_from_country
                }
            }
            event_target:old_owner = {
                save_event_target_as = ccrebel_revolted_from_country
            }
        }
    }
    option = {
        name = ccrebel_sow_unrest.4.option.A
        custom_tooltip = ccrebel_sow_unrest.4.option.A.tooltip
        ai_chance = {
            factor = 8
            modifier = {
                factor = 0
                opinion = {
                    who = event_target:ccrebel_subsidised_rebels
                    value < -80
                }
            }
            modifier = {
                factor = 0
                OR = {
                    is_hostile_to = event_target:ccrebel_subsidised_rebels
                    is_rival = event_target:ccrebel_subsidised_rebels
                    is_domineering_to = event_target:ccrebel_subsidised_rebels
                    is_disloyal_to = event_target:ccrebel_subsidised_rebels
                }
            }
            modifier = {
                factor = 1.5
                OR = {
                    is_friendly_to = event_target:ccrebel_subsidised_rebels
                    is_cordial_to = event_target:ccrebel_subsidised_rebels
                }
            }
            modifier = {
                factor = 0.25
                cc_su_target_opposite_ethic = yes
            }
            modifier = {
                factor = 0.5
                cc_su_target_half_opposite_ethic = yes
            }
            modifier = {
                factor = 0.75
                cc_su_target_quarter_opposite_ethic = yes
            }
            modifier = {
                factor = 0.5
                has_ai_personality_behaviour = conqueror
            }
            modifier = {
                factor = 1.5
                has_ai_personality_behaviour = liberator
            }
            modifier = {
                factor = 2
                has_ai_personality_behaviour = subjugator
            }
            modifier = {
                factor = 3
                is_at_war_with = event_target:ccrebel_revolted_from_country
            }
            modifier = {
                factor = 0
                NAND = {
                    OR = {
                        has_country_resource = {
                            type = minerals
                            amount > 8000
                        }
                        has_monthly_income = {
                            resource = minerals
                            value > 400
                        }
                    }
                    OR = {
                        has_monthly_income = {
                            resource = energy
                            value > 400
                        }
                        resource_stockpile_compare = {
                            resource = energy
                            value > 8000
                        }
                    }
                }
            }
            modifier = {
                factor = 0.1
                NAND = {
                    OR = {
                        has_country_resource = {
                            type = minerals
                            amount > 10000
                        }
                        has_monthly_income = {
                            resource = minerals
                            value > 500
                        }
                    }
                    OR = {
                        has_monthly_income = {
                            resource = energy
                            value > 500
                        }
                        resource_stockpile_compare = {
                            resource = energy
                            value > 10000
                        }
                    }
                }
            }
            modifier = {
                factor = 2
                OR = {
                    has_country_resource = {
                        type = minerals
                        amount > 15000
                    }
                    has_monthly_income = {
                        resource = minerals
                        value > 800
                    }
                }
                OR = {
                    has_monthly_income = {
                        resource = energy
                        value > 800
                    }
                    resource_stockpile_compare = {
                        resource = energy
                        value > 15000
                    }
                }
            }
            modifier = {
                factor = 0
                NOT = {
                    event_target:ccrebel_subsidised_rebels.capital_scope = {
                        any_country = {
                            NOT = {
                                is_same_value = prev
                            }
                            OR = {
                                root = {
                                    is_threatened_to = prev
                                    is_hostile_to = prev
                                    is_dismissive_to = prev
                                    is_patronizing_to = prev
                                    is_angry_to = prev
                                    is_rival = prev
                                    is_unfriendly_to = prev
                                    is_disloyal_to = prev
                                    is_domineering_to = prev
                                }
                            }
                            any_owned_planet = {
                                distance = {
                                    source = prevprev
                                    max_distance <= 75
                                }
                            }
                        }
                    }
                }
            }
            modifier = {
                factor = 2
                event_target:ccrebel_subsidised_rebels.capital_scope = {
                    any_country = {
                        NOT = {
                            is_same_value = prev
                        }
                        OR = {
                            root = {
                                is_threatened_to = prev
                                is_hostile_to = prev
                                is_rival = prev
                                is_disloyal_to = prev
                            }
                        }
                        any_owned_planet = {
                            distance = {
                                source = prevprev
                                max_distance <= 75
                            }
                        }
                    }
                }
            }
        }
        hidden_effect = {
            event_target:ccrebel_revolted_from_country = {
                add_opinion_modifier = {
                    who = root
                    modifier = opinion_ccrebel_subsidising_our_rebels
                }
                add_opinion_modifier = {
                    who = root
                    modifier = opinion_ccrebel_subsidising_our_rebels
                }
                if = {
                    limit = {
                        NOT = {
                            has_country_flag = ccrebel_they_gave_a_fleet
                        }
                        is_ai = no
                    }
                    root = {
                        save_event_target_as = ccrebel_naughty_country
                    }
                    country_event = {
                        id = ccrebel_sow_unrest.7
                        days = 30
                    }
                }
            }
            ccrebel_add_level_3_rebel_subsidiser = yes
            set_timed_relation_flag = {
                who = event_target:ccrebel_subsidised_rebels
                flag = ccrebel_subsidiser
                days = 3610
            }
            country_event = {
                id = ccrebel_sow_unrest.6
            }
            country_event = {
                id = ccrebel_sow_unrest.5
                days = 3605
            }
            event_target:ccrebel_subsidised_rebels = {
                ccrebel_add_level_3_rebel_subsidies = yes
                add_opinion_modifier = {
                    who = root
                    modifier = opinion_ccrebel_subsidised
                }
                add_opinion_modifier = {
                    who = root
                    modifier = opinion_ccrebel_subsidised
                }
                add_opinion_modifier = {
                    who = root
                    modifier = opinion_ccrebel_subsidised
                }
            }
        }
    }
    option = {
        name = ccrebel_sow_unrest.4.option.B
        custom_tooltip = ccrebel_sow_unrest.4.option.B.tooltip
        ai_chance = {
            factor = 4
            modifier = {
                factor = 0
                OR = {
                    is_hostile_to = event_target:ccrebel_subsidised_rebels
                    is_rival = event_target:ccrebel_subsidised_rebels
                    is_domineering_to = event_target:ccrebel_subsidised_rebels
                    is_disloyal_to = event_target:ccrebel_subsidised_rebels
                }
            }
            modifier = {
                factor = 1.5
                OR = {
                    is_friendly_to = event_target:ccrebel_subsidised_rebels
                    is_cordial_to = event_target:ccrebel_subsidised_rebels
                }
            }
            modifier = {
                factor = 0.25
                cc_su_target_opposite_ethic = yes
            }
            modifier = {
                factor = 0.5
                cc_su_target_half_opposite_ethic = yes
            }
            modifier = {
                factor = 0.75
                cc_su_target_quarter_opposite_ethic = yes
            }
            modifier = {
                factor = 0.5
                has_ai_personality_behaviour = conqueror
            }
            modifier = {
                factor = 1.5
                has_ai_personality_behaviour = liberator
            }
            modifier = {
                factor = 2
                has_ai_personality_behaviour = subjugator
            }
            modifier = {
                factor = 3
                is_at_war_with = event_target:ccrebel_revolted_from_country
            }
            modifier = {
                factor = 0
                NAND = {
                    OR = {
                        has_country_resource = {
                            type = minerals
                            amount > 4000
                        }
                        has_monthly_income = {
                            resource = minerals
                            value > 200
                        }
                    }
                    OR = {
                        has_monthly_income = {
                            resource = energy
                            value > 200
                        }
                        resource_stockpile_compare = {
                            resource = energy
                            value > 4000
                        }
                    }
                }
            }
            modifier = {
                factor = 0.25
                NAND = {
                    OR = {
                        has_country_resource = {
                            type = minerals
                            amount > 5000
                        }
                        has_monthly_income = {
                            resource = minerals
                            value > 250
                        }
                    }
                    OR = {
                        has_monthly_income = {
                            resource = energy
                            value > 250
                        }
                        resource_stockpile_compare = {
                            resource = energy
                            value > 5000
                        }
                    }
                }
            }
            modifier = {
                factor = 2
                OR = {
                    has_country_resource = {
                        type = minerals
                        amount > 8000
                    }
                    has_monthly_income = {
                        resource = minerals
                        value > 400
                    }
                }
                OR = {
                    has_monthly_income = {
                        resource = energy
                        value > 400
                    }
                    resource_stockpile_compare = {
                        resource = energy
                        value > 8000
                    }
                }
            }
            modifier = {
                factor = 0
                NOT = {
                    event_target:ccrebel_subsidised_rebels.capital_scope = {
                        any_country = {
                            NOT = {
                                is_same_value = prev
                            }
                            OR = {
                                root = {
                                    is_threatened_to = prev
                                    is_hostile_to = prev
                                    is_dismissive_to = prev
                                    is_patronizing_to = prev
                                    is_angry_to = prev
                                    is_rival = prev
                                    is_unfriendly_to = prev
                                    is_disloyal_to = prev
                                    is_domineering_to = prev
                                }
                            }
                            any_owned_planet = {
                                distance = {
                                    source = prevprev
                                    max_distance <= 75
                                }
                            }
                        }
                    }
                }
            }
            modifier = {
                factor = 2
                event_target:ccrebel_subsidised_rebels.capital_scope = {
                    any_country = {
                        NOT = {
                            is_same_value = prev
                        }
                        OR = {
                            root = {
                                is_threatened_to = prev
                                is_hostile_to = prev
                                is_rival = prev
                                is_disloyal_to = prev
                            }
                        }
                        any_owned_planet = {
                            distance = {
                                source = prevprev
                                max_distance <= 75
                            }
                        }
                    }
                }
            }
        }
        hidden_effect = {
            event_target:ccrebel_revolted_from_country = {
                add_opinion_modifier = {
                    who = root
                    modifier = opinion_ccrebel_subsidising_our_rebels
                }
                if = {
                    limit = {
                        NOT = {
                            has_country_flag = ccrebel_they_gave_a_fleet
                        }
                        is_ai = no
                    }
                    root = {
                        save_event_target_as = ccrebel_naughty_country
                    }
                    country_event = {
                        id = ccrebel_sow_unrest.7
                        days = 30
                    }
                }
            }
            ccrebel_add_level_2_rebel_subsidiser = yes
            set_timed_relation_flag = {
                who = event_target:ccrebel_subsidised_rebels
                flag = ccrebel_subsidiser
                days = 3610
            }
            country_event = {
                id = ccrebel_sow_unrest.6
            }
            country_event = {
                id = ccrebel_sow_unrest.5
                days = 3605
            }
            event_target:ccrebel_subsidised_rebels = {
                ccrebel_add_level_2_rebel_subsidies = yes
                add_opinion_modifier = {
                    who = root
                    modifier = opinion_ccrebel_subsidised
                }
                add_opinion_modifier = {
                    who = root
                    modifier = opinion_ccrebel_subsidised
                }
            }
        }
    }
    option = {
        name = ccrebel_sow_unrest.4.option.C
        custom_tooltip = ccrebel_sow_unrest.4.option.C.tooltip
        ai_chance = {
            factor = 2
            modifier = {
                factor = 0
                OR = {
                    is_hostile_to = event_target:ccrebel_subsidised_rebels
                    is_rival = event_target:ccrebel_subsidised_rebels
                    is_domineering_to = event_target:ccrebel_subsidised_rebels
                    is_disloyal_to = event_target:ccrebel_subsidised_rebels
                }
            }
            modifier = {
                factor = 1.5
                OR = {
                    is_friendly_to = event_target:ccrebel_subsidised_rebels
                    is_cordial_to = event_target:ccrebel_subsidised_rebels
                }
            }
            modifier = {
                factor = 0.25
                cc_su_target_opposite_ethic = yes
            }
            modifier = {
                factor = 0.5
                cc_su_target_half_opposite_ethic = yes
            }
            modifier = {
                factor = 0.75
                cc_su_target_quarter_opposite_ethic = yes
            }
            modifier = {
                factor = 0.5
                has_ai_personality_behaviour = conqueror
            }
            modifier = {
                factor = 1.5
                has_ai_personality_behaviour = liberator
            }
            modifier = {
                factor = 2
                has_ai_personality_behaviour = subjugator
            }
            modifier = {
                factor = 3
                is_at_war_with = event_target:ccrebel_revolted_from_country
            }
            modifier = {
                factor = 0
                NAND = {
                    OR = {
                        has_country_resource = {
                            type = minerals
                            amount > 2000
                        }
                        has_monthly_income = {
                            resource = minerals
                            value > 100
                        }
                    }
                    OR = {
                        has_monthly_income = {
                            resource = energy
                            value > 100
                        }
                        resource_stockpile_compare = {
                            resource = energy
                            value > 2000
                        }
                    }
                }
            }
            modifier = {
                factor = 0.5
                NAND = {
                    OR = {
                        has_country_resource = {
                            type = minerals
                            amount > 2500
                        }
                        has_monthly_income = {
                            resource = minerals
                            value > 125
                        }
                    }
                    OR = {
                        has_monthly_income = {
                            resource = energy
                            value > 125
                        }
                        resource_stockpile_compare = {
                            resource = energy
                            value > 2500
                        }
                    }
                }
            }
            modifier = {
                factor = 2
                OR = {
                    has_country_resource = {
                        type = minerals
                        amount > 4000
                    }
                    has_monthly_income = {
                        resource = minerals
                        value > 200
                    }
                }
                OR = {
                    has_monthly_income = {
                        resource = energy
                        value > 200
                    }
                    resource_stockpile_compare = {
                        resource = energy
                        value > 4000
                    }
                }
            }
            modifier = {
                factor = 0
                NOT = {
                    event_target:ccrebel_subsidised_rebels.capital_scope = {
                        any_country = {
                            NOT = {
                                is_same_value = prev
                            }
                            OR = {
                                root = {
                                    is_threatened_to = prev
                                    is_hostile_to = prev
                                    is_dismissive_to = prev
                                    is_patronizing_to = prev
                                    is_angry_to = prev
                                    is_rival = prev
                                    is_unfriendly_to = prev
                                    is_disloyal_to = prev
                                    is_domineering_to = prev
                                }
                            }
                            any_owned_planet = {
                                distance = {
                                    source = prevprev
                                    max_distance <= 75
                                }
                            }
                        }
                    }
                }
            }
            modifier = {
                factor = 2
                event_target:ccrebel_subsidised_rebels.capital_scope = {
                    any_country = {
                        NOT = {
                            is_same_value = prev
                        }
                        OR = {
                            root = {
                                is_threatened_to = prev
                                is_hostile_to = prev
                                is_rival = prev
                                is_disloyal_to = prev
                            }
                        }
                        any_owned_planet = {
                            distance = {
                                source = prevprev
                                max_distance <= 75
                            }
                        }
                    }
                }
            }
        }
        hidden_effect = {
            event_target:ccrebel_revolted_from_country = {
                add_opinion_modifier = {
                    who = root
                    modifier = opinion_ccrebel_subsidising_our_rebels
                }
                if = {
                    limit = {
                        NOT = {
                            has_country_flag = ccrebel_they_gave_a_fleet
                        }
                        is_ai = no
                    }
                    root = {
                        save_event_target_as = ccrebel_naughty_country
                    }
                    country_event = {
                        id = ccrebel_sow_unrest.7
                        days = 30
                    }
                }
            }
            ccrebel_add_level_1_rebel_subsidiser = yes
            set_timed_relation_flag = {
                who = event_target:ccrebel_subsidised_rebels
                flag = ccrebel_subsidiser
                days = 3610
            }
            country_event = {
                id = ccrebel_sow_unrest.6
            }
            country_event = {
                id = ccrebel_sow_unrest.5
                days = 3605
            }
            event_target:ccrebel_subsidised_rebels = {
                ccrebel_add_level_1_rebel_subsidies = yes
                add_opinion_modifier = {
                    who = root
                    modifier = opinion_ccrebel_subsidised
                }
            }
        }
    }
    option = {
        name = ccrebel_sow_unrest.4.option.D
        ai_chance = {
            factor = 1
        }
    }
}
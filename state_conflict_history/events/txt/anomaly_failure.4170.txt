namespace = anomaly_failure
planet_event = {
    id = anomaly_failure.4170
    title = DISC_FAILURE
    desc = {
        text = "anomaly_failure.4170.individ.desc"
        trigger = {
            owner = {
                OR = {
                    has_ethic = ethic_fanatic_egalitarian
                    has_ethic = ethic_egalitarian
                }
            }
        }
    }
    desc = {
        text = "anomaly_failure.4170.basic.desc"
        trigger = {
            owner = {
                NOR = {
                    has_ethic = ethic_fanatic_egalitarian
                    has_ethic = ethic_egalitarian
                }
            }
        }
    }
    picture = GFX_evt_nuclear_explosion
    show_sound = event_ship_explosion
    location = from
    is_triggered_only = yes
    immediate = {
        hidden_effect = {
            from = {
                remove_deposit = d_bubbling_swamp
                remove_modifier = gas_rich_planet_fo_realz
                if = {
                    limit = {
                        num_pops > 4
                    }
                    random_owned_pop = {
                        kill_pop = yes
                    }
                    random_owned_pop = {
                        kill_pop = yes
                    }
                    random_owned_pop = {
                        kill_pop = yes
                    }
                    owner = {
                        set_country_flag = gas_explosion_deaths_3
                    }
                    break = yes
                }
                if = {
                    limit = {
                        num_pops > 3
                    }
                    random_owned_pop = {
                        kill_pop = yes
                    }
                    random_owned_pop = {
                        kill_pop = yes
                    }
                    owner = {
                        set_country_flag = gas_explosion_deaths_2
                    }
                    break = yes
                }
                if = {
                    limit = {
                        num_pops > 2
                    }
                    random_owned_pop = {
                        kill_pop = yes
                    }
                    owner = {
                        set_country_flag = gas_explosion_deaths_1
                    }
                    break = yes
                }
                if = {
                    limit = {
                        OR = {
                            num_pops = 2
                            num_pops < 2
                        }
                    }
                    owner = {
                        set_country_flag = gas_explosion_deaths_0
                    }
                    break = yes
                }
            }
        }
    }
    option = {
        name = CURSES
        custom_tooltip = "anomaly_failure.4170.a.tooltip"
        tooltip = {
            remove_deposit = d_bubbling_swamp
        }
        trigger = {
            owner = {
                has_country_flag = gas_explosion_deaths_0
            }
        }
    }
    option = {
        name = CURSES
        custom_tooltip = "anomaly_failure.4170.b.tooltip"
        tooltip = {
            remove_deposit = d_bubbling_swamp
        }
        trigger = {
            owner = {
                has_country_flag = gas_explosion_deaths_1
            }
        }
    }
    option = {
        name = CURSES
        custom_tooltip = "anomaly_failure.4170.c.tooltip"
        tooltip = {
            remove_deposit = d_bubbling_swamp
        }
        trigger = {
            owner = {
                has_country_flag = gas_explosion_deaths_2
            }
        }
    }
    option = {
        name = CURSES
        custom_tooltip = "anomaly_failure.4170.d.tooltip"
        tooltip = {
            remove_deposit = d_bubbling_swamp
        }
        trigger = {
            owner = {
                has_country_flag = gas_explosion_deaths_3
            }
        }
    }
}
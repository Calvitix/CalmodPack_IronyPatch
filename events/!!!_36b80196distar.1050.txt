namespace = distar
ship_event = {
    id = distar.1050
    title = "distar.1050.name"
    picture = GFX_evt_space_debris
    show_sound = event_alien_nature
    location = FROM
    is_triggered_only = yes
    desc = {
        trigger = {
            owner = {
                is_lithoid_empire = no
                is_robot_empire = no
            }
        }
        text = distar.1050.desc
    }
    desc = {
        trigger = {
            owner = {
                is_lithoid_empire = yes
                is_robot_empire = no
            }
        }
        text = distar.1050.desc_lithoid
    }
    desc = {
        trigger = {
            owner = {
                has_country_flag = synthetic_empire
            }
        }
        text = distar.1050.desc_robot
    }
    desc = {
        trigger = {
            owner = {
                is_machine_empire = yes
            }
        }
        text = distar.1050.desc_machine
    }
    trigger = {
        any_country = {
            is_country_type = default
            NOT = {
                is_same_value = root.owner
            }
        }
    }
    immediate = {
        owner = {
            country_event = {
                id = story.5
                days = 30
            }
            set_country_flag = eat_or_be_eaten
        }
        random_playable_country = {
            limit = {
                NOR = {
                    is_same_value = root.owner
                    has_country_flag = lost_colony_parent
                    has_communications = root.owner
                    has_authority = auth_machine_intelligence
                    is_synthetic_empire = yes
                    owner_species = {
                        OR = {
                            has_trait = trait_mechanical
                            has_trait = trait_machine_unit
                            has_trait = trait_lithoid
                            AND = {
                                species_portrait = human
                                ROOT = {
                                    owner = {
                                        owner_species = {
                                            species_portrait = human
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
            weights = {
                base = 1
                modifier = {
                    mult = 10
                    has_communications = root.owner
                }
            }
            establish_communications = root.owner
            save_event_target_as = delicious_aliens
            root.owner = {
                set_country_flag = establishing_delicious_comms
            }
            save_event_target_as = delicious_aliens
            owner_species = {
                save_event_target_as = delicious_aliens_species
            }
            every_country = {
                every_owned_pop = {
                    limit = {
                        is_same_species = event_target:delicious_aliens_species
                    }
                    modify_species = {
                        species = THIS
                        add_trait = trait_delicious
                    }
                }
            }
            establish_communications_no_message = root.owner
            save_event_target_as = contact_empire
            root.owner = {
                set_country_flag = establishing_delicious_comms
            }
        }
    }
    option = {
        name = distar.1050.a
        hidden_effect = {
            if = {
                limit = {
                    root.owner = {
                        has_country_flag = establishing_delicious_comms
                    }
                }
                custom_tooltip = distar.1050.a.tooltip
                root.owner = {
                    country_event = {
                        id = action.1
                    }
                }
            }
        }
        owner = {
            add_monthly_resource_mult = {
                resource = society_research
                value = @tier2researchreward
                min = @tier2researchmin
                max = @tier2researchmax
            }
        }
    }
}

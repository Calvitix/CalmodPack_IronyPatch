namespace = leader
namespace = leader
country_event = {
    id = leader.1
    hide_window = yes
    is_triggered_only = yes
    trigger = {
        is_country_type = default
        fromfrom.solar_system = {
            check_variable = {
                which = mem_dpe_space_battle
                value > 10
            }
        }
    }
    immediate = {
        FROMFROM = {
            solar_system = {
                save_event_target_as = system
            }
            if = {
                limit = {
                    any_owned_ship = {
                        is_ship_size = battleship
                    }
                }
                random_owned_ship = {
                    limit = {
                        is_ship_size = battleship
                        has_hp > 0
                    }
                    save_event_target_as = ship
                }
            }
            else_if = {
                limit = {
                    any_owned_ship = {
                        is_ship_size = cruiser
                    }
                }
                random_owned_ship = {
                    limit = {
                        is_ship_size = cruiser
                        has_hp > 0
                    }
                    save_event_target_as = ship
                }
            }
            else = {
                random_owned_ship = {
                    limit = {
                        has_hp > 0
                    }
                    save_event_target_as = ship
                }
            }
        }
        random_list = {
            25 = {
                create_leader = {
                    class = admiral
                    species = owner_main_species
                    name = random
                    skill = 2
                    traits = {
                        trait = leader_trait_gale_speed
                        trait = leader_trait_aggressive
                    }
                }
                last_created_leader = {
                    save_event_target_as = officer
                }
            }
            25 = {
                create_leader = {
                    class = admiral
                    species = owner_main_species
                    name = random
                    skill = 2
                    traits = {
                        trait = leader_trait_aggressive
                        trait = leader_trait_dpe_talented
                    }
                }
                last_created_leader = {
                    save_event_target_as = officer
                }
            }
            25 = {
                create_leader = {
                    class = admiral
                    species = owner_main_species
                    name = random
                    skill = 2
                    traits = {
                        trait = leader_trait_fleet_logistician
                        trait = leader_trait_cautious
                    }
                }
                last_created_leader = {
                    save_event_target_as = officer
                }
            }
            25 = {
                create_leader = {
                    class = admiral
                    species = owner_main_species
                    name = random
                    skill = 2
                    traits = {
                        trait = leader_trait_scout
                        trait = leader_trait_trickster
                    }
                }
                last_created_leader = {
                    save_event_target_as = officer
                }
            }
        }
        if = {
            limit = {
                has_ethic = ethic_gestalt_consciousness
            }
            random_list = {
                1 = {
                    country_event = {
                        id = leader.91
                    }
                    modifier = {
                        factor = 3
                        NOT = {
                            exists = fromfrom.leader
                        }
                    }
                }
                7 = {
                    last_created_leader = {
                        kill_leader = {
                            show_notification = no
                        }
                    }
                }
            }
        }
        else_if = {
            limit = {
                NOT = {
                    exists = fromfrom.leader
                }
            }
            country_event = {
                id = leader.92
            }
        }
        else = {
            random_list = {
                1 = {
                    fromfrom.leader = {
                        save_event_target_as = dpe_admiral
                    }
                    set_timed_country_flag = {
                        flag = dpe_admiral
                        days = 5
                    }
                    country_event = {
                        id = leader.92
                    }
                }
                2 = {
                    last_created_leader = {
                        kill_leader = {
                            show_notification = no
                        }
                    }
                }
            }
        }
    }
}

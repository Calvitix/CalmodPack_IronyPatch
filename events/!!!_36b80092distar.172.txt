namespace = distar
ship_event = {
    id = distar.172
    title = "distar.172.name"
    desc = "distar.172.desc"
    picture = GFX_evt_hive_mind
    show_sound = event_alien_nature
    location = root
    is_triggered_only = yes
    trigger = {
        exists = event_target:brainslug_scientist
    }
    immediate = {
        leader = {
            add_trait = leader_trait_scientist_brainslug
            add_ruler_trait = leader_trait_ruler_brainslug
        }
        owner = {
            set_country_flag = finished_brainslug_chain
        }
    }
    option = {
        trigger = {
            owner = {
                NOR = {
                    has_ethic = ethic_xenophobe
                    has_ethic = ethic_fanatic_xenophobe
                }
            }
        }
        name = "distar.172.a"
        custom_tooltip = "distar.172.a.tooltip"
        allow = {
            owner = {
                is_homicidal = no
            }
        }
        owner = {
            while = {
                count = 3
                random_owned_pop = {
                    limit = {
                        is_sapient = yes
                        species = {
                            NOR = {
                                has_trait = trait_cybernetic
                                has_trait = trait_mechanical
                                has_trait = trait_machine_unit
                                is_species_class = ROBOT
                            }
                        }
                    }
                    modify_species = {
                        species = this
                        add_trait = trait_brainslug
                        add_traits_at_start_of_list = yes
                        hidden_effect = {
                            set_citizenship_type = {
                                country = root.owner
                                type = citizenship_full
                                cooldown = no
                            }
                        }
                    }
                }
            }
            hidden_effect = {
                while = {
                    count = 2
                    random_owned_leader = {
                        LIMIT = {
                            leader_class = scientist
                            species = {
                                NOR = {
                                    has_trait = trait_cybernetic
                                    has_trait = trait_mechanical
                                    has_trait = trait_machine_unit
                                    is_species_class = ROBOT
                                }
                            }
                        }
                        add_trait = leader_trait_scientist_brainslug
                        add_ruler_trait = leader_trait_ruler_brainslug
                    }
                }
                random_owned_leader = {
                    LIMIT = {
                        leader_class = governor
                        species = {
                            NOR = {
                                has_trait = trait_cybernetic
                                has_trait = trait_mechanical
                                has_trait = trait_machine_unit
                                is_species_class = ROBOT
                            }
                        }
                    }
                    add_trait = leader_trait_governor_brainslug
                    add_ruler_trait = leader_trait_ruler_brainslug
                }
                country_event = {
                    id = distar.174
                }
                country_event = {
                    id = distar.175
                }
            }
        }
    }
    option = {
        trigger = {
            hidden_trigger = {
                owner = {
                    OR = {
                        has_ethic = ethic_xenophobe
                        has_ethic = ethic_fanatic_xenophobe
                    }
                    any_owned_pop = {
                        NOR = {
                            has_ethic = ethic_xenophobe
                            has_ethic = ethic_fanatic_xenophobe
                        }
                    }
                }
            }
        }
        name = "distar.172.a"
        custom_tooltip = "distar.172.a.tooltip"
        allow = {
            owner = {
                is_homicidal = no
            }
        }
        owner = {
            while = {
                count = 3
                random_owned_pop = {
                    LIMIT = {
                        NOR = {
                            has_ethic = ethic_xenophobe
                            has_ethic = ethic_fanatic_xenophobe
                        }
                        species = {
                            NOR = {
                                has_trait = trait_cybernetic
                                has_trait = trait_mechanical
                                has_trait = trait_machine_unit
                                is_species_class = ROBOT
                            }
                        }
                        is_sapient = yes
                    }
                    modify_species = {
                        species = this
                        add_trait = trait_brainslug
                        add_traits_at_start_of_list = yes
                        hidden_effect = {
                            set_citizenship_type = {
                                country = root.owner
                                type = citizenship_full
                                cooldown = no
                            }
                        }
                    }
                }
            }
            hidden_effect = {
                country_event = {
                    id = distar.174
                }
                country_event = {
                    id = distar.175
                }
            }
        }
    }
    option = {
        name = "distar.172.b"
        custom_tooltip = "distar.172.b.tooltip"
        owner = {
            set_country_flag = brainslug_offer_rejected
        }
    }
}

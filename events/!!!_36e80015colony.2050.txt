namespace = colony
planet_event = {
    id = colony.2050
    title = colony.2050.name
    desc = colony.2050.desc
    picture = GFX_evt_colony_settlement
    show_sound = event_planetary_riot
    location = root
    trigger = {
        has_owner = yes
        original_owner = yes
        is_homeworld = no
        is_capital = no
        has_ground_combat = no
        is_occupied_flag = no
        num_pops > 2
        has_building = yes
        NOR = {
            has_planet_flag = colony_event
            is_planet_class = pc_habitat
        }
        owner = {
            NOT = {
                has_ethic = ethic_gestalt_consciousness
            }
        }
    }
    is_triggered_only = yes
    immediate = {
        set_planet_flag = colony_event
    }
    option = {
        name = UNFORTUNATE
        add_deposit = d_decrepit_dwellings
        add_deposit = d_failing_infrastructure
        hidden_effect = {
            random_list = {
                50 = {
                    random_pop = {
                        limit = {
                            is_valid_refugee_pop = yes
                        }
                        save_event_target_as = refugee_pop
                        refugee_pop_effect = yes
                    }
                }
                50 = {
                }
            }
        }
    }
    option = {
        name = colony.2050.b
        trigger = {
            owner = {
                resource_stockpile_compare = {
                    resource = influence
                    value >= 100
                }
                resource_stockpile_compare = {
                    resource = energy
                    value >= 500
                }
                NOR = {
                    has_ethic = ethic_fanatic_authoritarian
                    has_ethic = ethic_authoritarian
                }
            }
        }
        owner = {
            add_resource = {
                energy = -500
                influence = -100
            }
            add_monthly_resource_mult = {
                resource = unity
                value = @tier2unityreward
                min = @tier2unitymin
                max = @tier2unitymax
            }
        }
    }
    option = {
        name = colony.2050.c
        trigger = {
            owner = {
                resource_stockpile_compare = {
                    resource = influence
                    value >= 50
                }
                resource_stockpile_compare = {
                    resource = energy
                    value >= 250
                }
                OR = {
                    has_ethic = ethic_fanatic_authoritarian
                    has_ethic = ethic_authoritarian
                }
            }
        }
        owner = {
            add_resource = {
                energy = -250
                influence = -50
            }
            add_monthly_resource_mult = {
                resource = unity
                value = @tier2unityreward
            }
        }
    }
    option = {
        name = colony.2050.d
        add_planet_devastation = 20
        trigger = {
            owner = {
                OR = {
                    has_government = gov_despotic_hegemony
                    has_government = gov_totalitarian_regime
                    has_government = gov_despotic_empire
                    has_government = gov_feudal_empire
                    has_government = gov_constitutional_dictatorship
                    has_government = gov_military_commissariat
                    has_government = gov_citizen_republic
                    has_government = gov_megacorporation
                    has_government = gov_private
                    has_government = gov_criminal_syndicate
                    has_government = gov_private_criminal_syndicate
                    has_government = gov_subversive_cult
                    has_government = gov_private_subversive_cult
                    has_government = gov_military_dictatorship
                    has_government = gov_star_empire
                    has_government = gov_mortal_empire
                    has_government = gov_grim_council
                    has_government = gov_band_blood
                    has_government = gov_sacrificial_megachurch
                    has_government = gov_private_sacrificial_megachurch
                }
            }
        }
        owner = {
            add_monthly_resource_mult = {
                resource = influence
                value = @tier2influencereward
                min = @tier2influencemin
                max = @tier2influencemax
            }
        }
        random_owned_pop = {
            limit = {
                is_pop_category = worker
            }
            add_modifier = {
                modifier = pop_angered
                days = 7300
            }
        }
        random_owned_pop = {
            limit = {
                NOT = {
                    has_modifier = pop_angered
                }
                is_pop_category = worker
            }
            add_modifier = {
                modifier = pop_angered
                days = 7300
            }
        }
        hidden_effect = {
            random_list = {
                50 = {
                    random_pop = {
                        limit = {
                            is_valid_refugee_pop = yes
                        }
                        save_event_target_as = refugee_pop
                        refugee_pop_effect = yes
                    }
                }
                50 = {
                }
            }
        }
    }
}
